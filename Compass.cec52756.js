import{d as E,S as j,j as O,D as P,u as I,k as h,U as M,Z as $,bb as z,i as H,m as b,an as C,ak as q,aq as F,o as L,c as Y,a as i,f as W,a2 as Z,ad as G,b as r,aj as J,a4 as K,ao as Q,ap as l,bc as X,a9 as ee,aa as ae,ab as te}from"./index.569c17c0.js";import{g as d}from"./index.26c17e5e.js";const se=o=>(ee("data-v-8d9e1d9d"),o=o(),ae(),o),oe=["height","width"],ne={class:"w-full h-full"},le={class:"flex flex-col items-center justify-around"},ie={class:"flex items-center justify-between w-full my-1"},re=se(()=>i("span",{class:"mr-1 text-slate-100"},"Heading style",-1)),de={class:"w-40"};var N=(o=>(o.NORTH_UP="North Up",o.HEAD_UP="Head Up",o))(N||{});const ce=E({__name:"Compass",props:{widget:{}},setup(o){const V=j();O.registerUsage(P.heading);const D=I(),S=h(),c=h(),m=h(),R={[0]:"N",[45]:"NE",[90]:"E",[135]:"SE",[180]:"S",[225]:"SW",[270]:"W",[315]:"NW"},x=Object.values(N),n=M(o).widget;$(()=>{Object.keys(n.value.options).length===0&&(n.value.options={headingStyle:x[0]})});const{width:A,height:T}=z(S),g=H(()=>A.value<T.value?A.value:T.value),U=()=>{if(c.value===void 0||c.value===null)return;m.value===void 0&&(m.value=c.value.getContext("2d"));const e=m.value;Q(e);const a=.5*g.value,s=.13*g.value,u=.03*a;e.textAlign="center",e.strokeStyle="white",e.font=`bold ${s}px Arial`,e.fillStyle="white",e.lineWidth=u,e.textBaseline="middle";const f=.7*a,y=.4*a,_=.55*a;e.translate(a,a),e.font=`bold ${s}px Arial`,e.fillText(`${t.yawAngleDegrees.toFixed(0)}\xB0`,.15*s,0),e.rotate(l(-90)),n.value.options.headingStyle=="Head Up"&&e.rotate(l(t.yawAngleDegrees));for(const[v,B]of Object.entries(R))e.save(),e.rotate(l(Number(v))),e.beginPath(),e.moveTo(_,0),e.lineTo(f,0),e.textBaseline="bottom",e.font=`bold ${.7*s}px Arial`,e.translate(f*1.025,0),e.rotate(l(90)),e.fillText(B,0,0),e.stroke(),e.restore();for(const v of X(360))v%9===0&&(e.save(),e.lineWidth=.25*u,e.rotate(l(Number(v))),e.beginPath(),e.moveTo(1.1*_,0),e.lineTo(f,0),e.stroke(),e.restore());e.beginPath(),e.arc(0,0,f,0,l(360)),e.stroke(),n.value.options.headingStyle=="North Up"?e.rotate(l(t.yawAngleDegrees)):e.rotate(-l(t.yawAngleDegrees)),e.beginPath(),e.lineWidth=1,e.strokeStyle="red",e.fillStyle="red";const p=.05*a;e.moveTo(y,p),e.lineTo(_-.5*p,0),e.lineTo(y,-p),e.lineTo(y,p),e.closePath(),e.fill(),e.stroke()},w=h(0);let k;b(D.attitude,e=>{Math.abs(C(e.yaw-(k||0)))>.1&&(k=e.yaw,w.value=C(D.attitude.yaw))});const t=q({yawAngleDegrees:0});return b(w,()=>{const e=w.value,a=e<0?e+360:e,s=t.yawAngleDegrees>270&&a<90,u=t.yawAngleDegrees<90&&a>270;s?(d.to(t,.05,{yawAngleDegrees:0}),d.fromTo(t,.05,{yawAngleDegrees:0},{yawAngleDegrees:a})):u?(d.to(t,.05,{yawAngleDegrees:360}),d.fromTo(t,.05,{yawAngleDegrees:360},{yawAngleDegrees:a})):d.to(t,.1,{yawAngleDegrees:a})}),b(t,()=>{!V.isWidgetVisible(n.value)||F(()=>U())}),(e,a)=>(L(),Y(K,null,[i("div",{ref_key:"compassRoot",ref:S,class:"compass"},[i("canvas",{ref_key:"canvasRef",ref:c,height:g.value,width:g.value,class:"rounded-[15%] bg-slate-950/70"},null,8,oe)],512),W(J,{show:r(n).managerVars.configMenuOpen,"onUpdate:show":a[1]||(a[1]=s=>r(n).managerVars.configMenuOpen=s),class:"w-72"},{default:Z(()=>[i("div",ne,[i("div",le,[i("div",ie,[re,i("div",de,[W(G,{modelValue:r(n).options.headingStyle,"onUpdate:modelValue":a[0]||(a[0]=s=>r(n).options.headingStyle=s),options:r(x)},null,8,["modelValue","options"])])])])])]),_:1},8,["show"])],64))}});const pe=te(ce,[["__scopeId","data-v-8d9e1d9d"]]);export{pe as default};
